<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>iKan by hussam789</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">iKan</h1>
      <h2 class="project-tagline">Simple visual task board for construction projects</h2>
      <a href="https://github.com/hussam789/kanboard" class="btn">View on GitHub</a>
      <a href="https://github.com/hussam789/kanboard/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/hussam789/kanboard/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="ikan" class="anchor" href="#ikan" aria-hidden="true"><span class="octicon octicon-link"></span></a>iKan</h1>

<hr>

<p><img src="http://s22.postimg.org/jmufttie9/ic_launcher.png" alt="ikan_logo"></p>

<h2>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p><strong>iKan is a Construction site managment which implements the basic principles of <a href="https://en.wikipedia.org/wiki/Lean_construction">Lean construction</a>. the Project focuses on Kanban methodology, and to optimize the team work in the construction site and to save work time and make the steps of the work easier and cleaner.</strong></p>

<h3>
<a id="what-is-kanban" class="anchor" href="#what-is-kanban" aria-hidden="true"><span class="octicon octicon-link"></span></a>What is Kanban?</h3>

<p>Kanban is a methodology originally developed by Toyota to be more efficient.</p>

<p>There is only two constraints imposed by Kanban:</p>

<ul>
<li>Visualize your workflow</li>
<li>Limit your work in progress</li>
<li>Continuous flow</li>
<li>Changes can be made at anytime</li>
<li>Kanban board is persistent</li>
</ul>

<h2>
<a id="ikan-project" class="anchor" href="#ikan-project" aria-hidden="true"><span class="octicon octicon-link"></span></a>iKan project</h2>

<p>the project contains two main apps:</p>

<h3>
<a id="managment-website" class="anchor" href="#managment-website" aria-hidden="true"><span class="octicon octicon-link"></span></a>Managment website:</h3>

<p>This system is based on an opensource project called <a href="https://github.com/fguillot/kanboard">Kanboard</a>, which has basic functionality like: Kanban board, Creating tasks and project, Calendar ect...</p>

<p>iKan is a customized version of <a href="https://github.com/fguillot/kanboard">Kanboard</a>, for the purpose of adapting it to the construction site managment needs.</p>

<h3>
<a id="main-features" class="anchor" href="#main-features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Main Features:</h3>

<h4>
<a id="construction-trade" class="anchor" href="#construction-trade" aria-hidden="true"><span class="octicon octicon-link"></span></a>Construction Trade:</h4>

<p>For each project the Adimistrator/Project Manager can add/edit the list of Construction Trades that are participating in the project.
<img src="http://i.imgur.com/RRKSFbq.png" alt="construction_trade"></p>

<h4>
<a id="spaces" class="anchor" href="#spaces" aria-hidden="true"><span class="octicon octicon-link"></span></a>Spaces:</h4>

<p>For each project the Adimistrator/Project Manager can add a heirarchy of the spaces in the project
<img src="http://i.imgur.com/WeDN6Qv.png" alt="spaces"></p>

<blockquote>
<ul>
<li>To add an abbreviation to Spaces that have childen, type between parentheses.</li>
<li>Use @ sign to indicate that the space is for notation only and cannot be assosiated with any task</li>
</ul>

<p>Spaces are presisted as a json string inside Projects Table, in order to display the heirarchy and to save the json, we Serialize and deSerialize the json object of this structure:</p>
</blockquote>

<p><strong>Load and Save Spaces Methods</strong></p>

<div class="highlight highlight-javascript"><pre><span class="pl-k">function</span> <span class="pl-en">load_Spaces</span>() {
    <span class="pl-k">var</span> sp <span class="pl-k">=</span> $(<span class="pl-s"><span class="pl-pds">"</span>#demo<span class="pl-pds">"</span></span>).attr(<span class="pl-s"><span class="pl-pds">"</span>data-spaces<span class="pl-pds">"</span></span>);
    <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>spaces:<span class="pl-pds">'</span></span> <span class="pl-k">+</span> sp);
    <span class="pl-k">var</span> data;
    <span class="pl-k">if</span> (sp.<span class="pl-c1">length</span> <span class="pl-k">==</span> <span class="pl-c1">0</span>) {
        data <span class="pl-k">=</span> {name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Spaces<span class="pl-pds">"</span></span>};
    } <span class="pl-k">else</span> {
        data <span class="pl-k">=</span> <span class="pl-c1">JSON</span>.<span class="pl-c1">parse</span>(sp);
    }
}

$(<span class="pl-s"><span class="pl-pds">"</span>#save<span class="pl-pds">"</span></span>).<span class="pl-c1">click</span>(<span class="pl-k">function</span> () {
        <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>save<span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-c1">JSON</span>.stringify(demo.$data.treeData));
        $.ajax({
            cache<span class="pl-k">:</span> <span class="pl-c1">false</span>,
            url<span class="pl-k">:</span> $(<span class="pl-s"><span class="pl-pds">"</span>#demo<span class="pl-pds">"</span></span>).attr(<span class="pl-s"><span class="pl-pds">"</span>data-save-url<span class="pl-pds">"</span></span>),
            contentType<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>application/json<span class="pl-pds">"</span></span>,
            type<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>POST<span class="pl-pds">"</span></span>,
            processData<span class="pl-k">:</span> <span class="pl-c1">false</span>,
            data<span class="pl-k">:</span> <span class="pl-c1">JSON</span>.stringify({
                <span class="pl-s"><span class="pl-pds">"</span>project_id<span class="pl-pds">"</span></span><span class="pl-k">:</span> $(<span class="pl-s"><span class="pl-pds">"</span>#demo<span class="pl-pds">"</span></span>).attr(<span class="pl-s"><span class="pl-pds">"</span>data-project-id<span class="pl-pds">"</span></span>),
                <span class="pl-s"><span class="pl-pds">"</span>spaces<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-c1">JSON</span>.stringify(demo.$data.treeData)
            }),
            <span class="pl-en">success</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">spaces</span>) {
                <span class="pl-c">//data = spaces;</span>
                <span class="pl-c1">alert</span>(<span class="pl-s"><span class="pl-pds">'</span>Saved spaces<span class="pl-pds">'</span></span>)
                <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>data saved<span class="pl-pds">'</span></span>);
            }
        });
    });</pre></div>

<p><strong>Spaces Data Object</strong></p>

<div class="highlight highlight-javascript"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Spaces<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>children<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
    {
      <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Level -1 - Parking<span class="pl-pds">"</span></span>
    },
    {
      <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Level 0 - Lobby<span class="pl-pds">"</span></span>
    },
    {
      <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>@Level 1 (L1)<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>children<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
        {
          <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>NE 3 Rooms Apt (NE3RMs)<span class="pl-pds">"</span></span>,
          <span class="pl-s"><span class="pl-pds">"</span>children<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Living Room<span class="pl-pds">"</span></span>
            },
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Master Bedroom<span class="pl-pds">"</span></span>
            },
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Children Bedroom<span class="pl-pds">"</span></span>
            }
          ]
        },
        {
          <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>NW 4 Rooms Apt (NW4RMs)<span class="pl-pds">"</span></span>,
          <span class="pl-s"><span class="pl-pds">"</span>children<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Living Room<span class="pl-pds">"</span></span>
            },
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Master Bedroom<span class="pl-pds">"</span></span>
            },
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Children Bedroom A<span class="pl-pds">"</span></span>
            },
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Children Bedroom B<span class="pl-pds">"</span></span>
            }
          ]
        },
        {
          <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>SW 4 Rooms Apt (SW4RMs)<span class="pl-pds">"</span></span>,
          <span class="pl-s"><span class="pl-pds">"</span>children<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Living Room<span class="pl-pds">"</span></span>
            },
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Master Bedroom<span class="pl-pds">"</span></span>
            },
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Children Bedroom A<span class="pl-pds">"</span></span>
            },
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Children Bedroom B<span class="pl-pds">"</span></span>
            }
          ]
        },
        {
          <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>SE 3 Rooms Apt (SE3RMs)<span class="pl-pds">"</span></span>,
          <span class="pl-s"><span class="pl-pds">"</span>children<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Living Room<span class="pl-pds">"</span></span>
            },
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Master Bedroom<span class="pl-pds">"</span></span>
            },
            {
              <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Children Bedroom<span class="pl-pds">"</span></span>
            }
          ]
        }
      ]
    }
  ]
}</pre></div>

<h4>
<a id="links" class="anchor" href="#links" aria-hidden="true"><span class="octicon octicon-link"></span></a>Links:</h4>

<p>Tasks can be linked together with predefined relationships:</p>

<p>The Administrator can edit list of Links/Relations between Tasks</p>

<blockquote>
<p>Material links cannot be removed since they are part of the system</p>
</blockquote>

<p><img src="http://i.imgur.com/HkzoFFY.png" alt="links"></p>

<h4>
<a id="creating-new-tasks" class="anchor" href="#creating-new-tasks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creating new Tasks:</h4>

<p>The Admin/Project manager can create new tasks by specifying:</p>

<ol>
<li>title</li>
<li>Description (Markdown Text)</li>
<li>Choose Assignee</li>
<li>Selecting Spaces that needs to create Tasks (one task per space) </li>
<li>Materials should be added with comma separation, example : Asphalt, Sand, Water</li>
<li>Color, Time Estimate, Due Date</li>
</ol>

<blockquote>
<p>For each Space a Task will be created with a link to a new Material task with list of materials as Subtasks.</p>

<ol>
<li> you can select one or more space by holding on Ctrl key or Shift key</li>
<li> When selecting "All Spaces" option it will create tasks for all </li>
</ol>
</blockquote>

<p><img src="http://i.imgur.com/aPbQ1XW.png" alt="new_task"></p>

<p><strong>Parsing Spaces</strong></p>

<p>Parse Spaces Json and getting list of Spaces with Abbreviated Path (handeling @ signs, Trimming spaces), using <strong>Recursive method</strong></p>

<div class="highlight highlight-javascript"><pre>    <span class="pl-k">function</span> <span class="pl-en">recursive_spaces_walkthrough</span> (<span class="pl-smi">$array</span>, <span class="pl-smi">$level</span>, &amp;<span class="pl-smi">$new_array</span>, <span class="pl-smi">$path</span>){
        <span class="pl-k">if</span> (empty($array)) {
            <span class="pl-k">return</span>;
        }
        $aabreviation <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>;
        <span class="pl-en">foreach</span>(<span class="pl-smi">$array</span> <span class="pl-smi">as</span> <span class="pl-smi">$key</span> <span class="pl-k">=</span>&gt; <span class="pl-smi">$value</span>){
            <span class="pl-c">//If $value is an array.</span>
            <span class="pl-k">if</span>(is_array($value)){
                <span class="pl-c">// walkthrough its children</span>
                $<span class="pl-v">this</span><span class="pl-k">-&gt;</span>recursive($value, $level <span class="pl-k">+</span> <span class="pl-c1">1</span>, $new_array, $path . $aabreviation);
            } <span class="pl-k">else</span> {
                <span class="pl-k">if</span> ($level <span class="pl-k">==</span> <span class="pl-c1">0</span>) {
                    <span class="pl-c">// Default Space</span>
                    $new_array[$value] <span class="pl-k">=</span> $value;
                    <span class="pl-k">continue</span>;
                }
                <span class="pl-c">//It is not an array, so print it out.</span>
               <span class="pl-c">//Check if Space name has Abbreviation in Parentheses ().</span>
               <span class="pl-k">if</span> (preg_match(<span class="pl-s"><span class="pl-pds">'</span>/<span class="pl-cce">\(</span>([A-Za-z0-9 ]+?)<span class="pl-cce">\)</span>/<span class="pl-pds">'</span></span>, $value, $matches)) {
                    $aabreviation <span class="pl-k">=</span> $level <span class="pl-k">==</span> <span class="pl-c1">1</span> <span class="pl-k">?</span> trim($matches[<span class="pl-c1">1</span>]) <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>.<span class="pl-pds">'</span></span> . trim($matches[<span class="pl-c1">1</span>]);
                } <span class="pl-k">else</span> {
                    $aabreviation <span class="pl-k">=</span> $level <span class="pl-k">==</span> <span class="pl-c1">1</span> <span class="pl-k">?</span> trim(str_replace(<span class="pl-s"><span class="pl-pds">'</span>@<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>,$value)) <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>.<span class="pl-pds">'</span></span> . trim(str_replace(<span class="pl-s"><span class="pl-pds">'</span>@<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>,$value));
                }

                <span class="pl-k">if</span> ($value[<span class="pl-c1">0</span>] <span class="pl-k">!=</span> <span class="pl-s"><span class="pl-pds">'</span>@<span class="pl-pds">'</span></span>) {
                    $newString <span class="pl-k">=</span> $path . <span class="pl-s"><span class="pl-pds">'</span>.<span class="pl-pds">'</span></span> . trim(preg_replace(<span class="pl-s"><span class="pl-pds">'</span>/<span class="pl-cce">\(</span>([^()]*+|(?R))*<span class="pl-cce">\)\s</span>*/<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>, $value));
                    $newString <span class="pl-k">=</span> ltrim($newString, <span class="pl-s"><span class="pl-pds">'</span>.<span class="pl-pds">'</span></span>);
                    $new_array[$newString] <span class="pl-k">=</span> $newString;
                }
            }
        }
    }</pre></div>

<p><strong>Saving new Task</strong></p>

<div class="highlight highlight-php"><pre><span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c">     * Validate and save a new task</span></span>
<span class="pl-s1"><span class="pl-c">     *</span></span>
<span class="pl-s1"><span class="pl-c">     * <span class="pl-k">@access</span> <span class="pl-k">public</span></span></span>
<span class="pl-s1"><span class="pl-c">     */</span></span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">save</span>()</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-smi">$project</span> <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span>getProject();</span>
<span class="pl-s1">        <span class="pl-smi">$values</span> <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">request</span><span class="pl-k">-&gt;</span>getValues();</span>
<span class="pl-s1"></span>
<span class="pl-s1">        <span class="pl-c1">list</span>(<span class="pl-smi">$valid</span>, <span class="pl-smi">$errors</span>) <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">taskValidator</span><span class="pl-k">-&gt;</span>validateCreation(<span class="pl-smi">$values</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1">        <span class="pl-k">if</span> (<span class="pl-smi">$valid</span>) {</span>
<span class="pl-s1">            <span class="pl-c">// ikan</span></span>
<span class="pl-s1">            <span class="pl-c">// if "all spaces" is selected: create tasks for all the spaces</span></span>
<span class="pl-s1">            <span class="pl-k">if</span> (<span class="pl-c1">in_array</span>(<span class="pl-k">self</span><span class="pl-k">::</span><span class="pl-c1">ALL_SPACES</span>, <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>spaces<span class="pl-pds">'</span></span>])) {</span>
<span class="pl-s1"></span>
<span class="pl-s1">                <span class="pl-smi">$space_list</span> <span class="pl-k">=</span> <span class="pl-c1">array</span>();</span>
<span class="pl-s1">             <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">taskFinder</span><span class="pl-k">-&gt;</span>recursive(<span class="pl-c1">json_decode</span>(<span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">project</span><span class="pl-k">-&gt;</span>getSpaces(<span class="pl-smi">$project</span>[<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>]), <span class="pl-c1">true</span>),</span>
<span class="pl-s1">              <span class="pl-c1">0</span>, <span class="pl-smi">$space_list</span>, <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>);</span>
<span class="pl-s1">                <span class="pl-k">if</span> (<span class="pl-c1">count</span>(<span class="pl-smi">$space_list</span>) <span class="pl-k">==</span> <span class="pl-c1">0</span>) {</span>
<span class="pl-s1">                    <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span>createSingleTask(<span class="pl-smi">$values</span>, <span class="pl-smi">$project</span>);</span>
<span class="pl-s1">                } <span class="pl-k">else</span> {</span>
<span class="pl-s1">                    <span class="pl-smi">$output</span> <span class="pl-k">=</span> <span class="pl-c1">print_r</span>(<span class="pl-smi">$space_list</span>,<span class="pl-c1">1</span>);</span>
<span class="pl-s1">                    <span class="pl-c1">error_log</span>(<span class="pl-smi">$output</span>);</span>
<span class="pl-s1">                    <span class="pl-k">foreach</span> (<span class="pl-smi">$space_list</span> <span class="pl-k">as</span> <span class="pl-smi">$space_name</span>) {</span>
<span class="pl-s1">                        <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>spaces<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-smi">$space_name</span>;</span>
<span class="pl-s1">                        <span class="pl-smi">$temp_title</span> <span class="pl-k">=</span> <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>];</span>
<span class="pl-s1">                        <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>] <span class="pl-k">.=</span> <span class="pl-s"><span class="pl-pds">'</span> - <span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-c1">str_replace</span>(<span class="pl-s"><span class="pl-pds">'</span>_<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>, <span class="pl-smi">$space_name</span>);</span>
<span class="pl-s1">                        <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span>createSingleTask(<span class="pl-smi">$values</span>, <span class="pl-smi">$project</span>);</span>
<span class="pl-s1">                        <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-smi">$temp_title</span>;</span>
<span class="pl-s1">                    }</span>
<span class="pl-s1">                }</span>
<span class="pl-s1">            } <span class="pl-k">else</span> {</span>
<span class="pl-s1">            <span class="pl-c">// for each one of the selected spaces create Task</span></span>
<span class="pl-s1">                <span class="pl-k">foreach</span> (<span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>spaces<span class="pl-pds">'</span></span>] <span class="pl-k">as</span> <span class="pl-smi">$selectedOption</span>) {</span>
<span class="pl-s1">                    <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>spaces<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-smi">$selectedOption</span>;</span>
<span class="pl-s1">                    <span class="pl-smi">$temp_title</span> <span class="pl-k">=</span> <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>];</span>
<span class="pl-s1">                    <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>] <span class="pl-k">.=</span> <span class="pl-s"><span class="pl-pds">'</span> - <span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$selectedOption</span>;</span>
<span class="pl-s1">                    <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span>createSingleTask(<span class="pl-smi">$values</span>, <span class="pl-smi">$project</span>);</span>
<span class="pl-s1">                    <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-smi">$temp_title</span>;</span>
<span class="pl-s1">                }</span>
<span class="pl-s1">            }</span>
<span class="pl-s1">            <span class="pl-k">.</span></span>
<span class="pl-s1">            <span class="pl-k">.</span></span>
<span class="pl-s1">            <span class="pl-k">.</span></span>
<span class="pl-s1">        }</span>
<span class="pl-s1">        <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span>create(<span class="pl-smi">$values</span>, <span class="pl-smi">$errors</span>);</span>
<span class="pl-s1">    }</span></pre></div>

<div class="highlight highlight-php"><pre><span class="pl-s1"><span class="pl-k">private</span> <span class="pl-k">function</span> <span class="pl-en">createSingleTask</span>(<span class="pl-smi">$values</span>, <span class="pl-smi">$project</span>)</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-smi">$materialTaskId</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;</span>
<span class="pl-s1">        <span class="pl-c">// if the task requires materials</span></span>
<span class="pl-s1">        <span class="pl-k">if</span> (<span class="pl-k">!</span><span class="pl-c1">empty</span>(<span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>materials<span class="pl-pds">'</span></span>])) {</span>
<span class="pl-s1">            <span class="pl-c">// get Materials Category id</span></span>
<span class="pl-s1">            <span class="pl-k">global</span> <span class="pl-smi">$materialCatId</span>;</span>
<span class="pl-s1">            <span class="pl-smi">$materialCatId</span> <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">category</span><span class="pl-k">-&gt;</span>getIdByName(<span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>project_id<span class="pl-pds">'</span></span>], <span class="pl-s"><span class="pl-pds">'</span>Materials<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">            <span class="pl-k">if</span> (<span class="pl-smi">$materialCatId</span> <span class="pl-k">==</span> <span class="pl-c1">0</span> ) {</span>
<span class="pl-s1">                <span class="pl-c">// if not exist create Material Category</span></span>
<span class="pl-s1">                <span class="pl-smi">$materialCatId</span> <span class="pl-k">=</span> (<span class="pl-k">int</span>) <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">category</span><span class="pl-k">-&gt;</span>create(<span class="pl-c1">array</span>(</span>
<span class="pl-s1">                    <span class="pl-s"><span class="pl-pds">'</span>project_id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>project_id<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">                    <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>Materials<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                ));</span>
<span class="pl-s1">            }</span>
<span class="pl-s1">            <span class="pl-c">// Create Material Task </span></span>
<span class="pl-s1">            <span class="pl-smi">$materialTaskValues</span> <span class="pl-k">=</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>Materials - <span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>project_id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>project_id<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>color_id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>column_id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">0</span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>owner_id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">0</span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>creator_id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>creator_id<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>date_due<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>description<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>category_id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$materialCatId</span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>spaces<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>spaces<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>score<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">0</span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>swimlane_id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>swimlane_id<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">            );</span>
<span class="pl-s1">            <span class="pl-smi">$materialTaskId</span> <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">taskCreation</span><span class="pl-k">-&gt;</span>create(<span class="pl-smi">$materialTaskValues</span>);</span>
<span class="pl-s1">            <span class="pl-c">// Create Materials subtasks</span></span>
<span class="pl-s1">            <span class="pl-smi">$materials</span> <span class="pl-k">=</span> <span class="pl-c1">explode</span>(<span class="pl-s"><span class="pl-pds">'</span>,<span class="pl-pds">'</span></span>, <span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>materials<span class="pl-pds">'</span></span>]);</span>
<span class="pl-s1">            <span class="pl-k">foreach</span> (<span class="pl-smi">$materials</span> <span class="pl-k">as</span> <span class="pl-smi">$key</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$val</span>) {</span>
<span class="pl-s1"></span>
<span class="pl-s1">                <span class="pl-smi">$subTask</span> <span class="pl-k">=</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">                    <span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">trim</span>(<span class="pl-smi">$val</span>),</span>
<span class="pl-s1">                    <span class="pl-s"><span class="pl-pds">'</span>task_id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$materialTaskId</span>,</span>
<span class="pl-s1">                    <span class="pl-s"><span class="pl-pds">'</span>user_id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">0</span>,</span>
<span class="pl-s1">                    <span class="pl-s"><span class="pl-pds">'</span>time_estimated<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">0</span>,</span>
<span class="pl-s1">                    <span class="pl-s"><span class="pl-pds">'</span>time_spent<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">0</span>,</span>
<span class="pl-s1">                    <span class="pl-s"><span class="pl-pds">'</span>status<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">0</span>,</span>
<span class="pl-s1">                );</span>
<span class="pl-s1">                <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">subtask</span><span class="pl-k">-&gt;</span>create(<span class="pl-smi">$subTask</span>);</span>
<span class="pl-s1">            }</span>
<span class="pl-s1">        }</span>
<span class="pl-s1">        <span class="pl-c1">unset</span>(<span class="pl-smi">$values</span>[<span class="pl-s"><span class="pl-pds">'</span>materials<span class="pl-pds">'</span></span>]);</span>
<span class="pl-s1">        <span class="pl-smi">$originalTask</span> <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">taskCreation</span><span class="pl-k">-&gt;</span>create(<span class="pl-smi">$values</span>);</span>
<span class="pl-s1">        <span class="pl-k">if</span> (<span class="pl-smi">$originalTask</span>) {</span>
<span class="pl-s1">            <span class="pl-c">// link material task with original task</span></span>
<span class="pl-s1">            <span class="pl-k">if</span> (<span class="pl-smi">$materialTaskId</span> <span class="pl-k">!</span><span class="pl-k">=</span> <span class="pl-c1">0</span>) {</span>
<span class="pl-s1">                <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">taskLink</span><span class="pl-k">-&gt;</span>create(<span class="pl-smi">$materialTaskId</span>, <span class="pl-smi">$originalTask</span>, <span class="pl-c1">9</span>);</span>
<span class="pl-s1">            }</span>
<span class="pl-s1">            <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">session</span><span class="pl-k">-&gt;</span>flash(t(<span class="pl-s"><span class="pl-pds">'</span>Task created successfully.<span class="pl-pds">'</span></span>));</span>
<span class="pl-s1">            <span class="pl-k">return</span> <span class="pl-c1">true</span>;</span>
<span class="pl-s1">        } <span class="pl-k">else</span> {</span>
<span class="pl-s1">            <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">session</span><span class="pl-k">-&gt;</span>flashError(t(<span class="pl-s"><span class="pl-pds">'</span>Unable to create your task.<span class="pl-pds">'</span></span>));</span>
<span class="pl-s1">            <span class="pl-k">return</span> <span class="pl-c1">false</span>;</span>
<span class="pl-s1">        }</span></pre></div>

<p><img src="http://i.imgur.com/N96sIbq.png" alt="link">
<img src="http://i.imgur.com/gvxrwZy.png" alt="link"></p>

<h4>
<a id="board" class="anchor" href="#board" aria-hidden="true"><span class="octicon octicon-link"></span></a>Board:</h4>

<p>iKan uses Kanban Board to display its Tasks and Ikan devides the board into multiple Swimlane, each swimplane contains one Construction trade
<img src="http://i.imgur.com/OlqtEFp.png" alt="link"></p>

<p><strong>clicing on Actions -&gt; Collapse Tasks will display the tasks collapsed</strong></p>

<p><img src="http://i.imgur.com/ko9OzdZ.png" alt="link"></p>

<p><strong>Code snippet for loading board by Construction Trade/Categories</strong></p>

<div class="highlight highlight-php"><pre><span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">show</span>()</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-smi">$params</span> <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span>getProjectFilters(<span class="pl-s"><span class="pl-pds">'</span>board<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>show<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">        <span class="pl-c">// ikan swimlanes becomes Construction Trade</span></span>
<span class="pl-s1">        <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">response</span><span class="pl-k">-&gt;</span>html(<span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">template</span><span class="pl-k">-&gt;</span>layout(<span class="pl-s"><span class="pl-pds">'</span>board/private_view<span class="pl-pds">'</span></span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>categories_list<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">category</span><span class="pl-k">-&gt;</span>getList(<span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>project<span class="pl-pds">'</span></span>][<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>], <span class="pl-c1">false</span>),</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>users_list<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">projectPermission</span><span class="pl-k">-&gt;</span>getMemberList(<span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>project<span class="pl-pds">'</span></span>][<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>], <span class="pl-c1">false</span>),</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>swimlanes<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">taskFilter</span><span class="pl-k">-&gt;</span>search(<span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>filters<span class="pl-pds">'</span></span>][<span class="pl-s"><span class="pl-pds">'</span>search<span class="pl-pds">'</span></span>])</span>
<span class="pl-s1">                            <span class="pl-k">-&gt;</span>getBoardByTradeSwimlanes(<span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>project<span class="pl-pds">'</span></span>][<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>]),</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>description<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>project<span class="pl-pds">'</span></span>][<span class="pl-s"><span class="pl-pds">'</span>description<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>board_private_refresh_interval<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">config</span><span class="pl-k">-&gt;</span>get(<span class="pl-s"><span class="pl-pds">'</span>board_private_refresh_interval<span class="pl-pds">'</span></span>),</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>board_highlight_period<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">config</span><span class="pl-k">-&gt;</span>get(<span class="pl-s"><span class="pl-pds">'</span>board_highlight_period<span class="pl-pds">'</span></span>),</span>
<span class="pl-s1">        ) <span class="pl-k">+</span> <span class="pl-smi">$params</span>));</span>
<span class="pl-s1">    }</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">getBoardByTradeSwimlanes</span>(<span class="pl-smi">$project_id</span>)</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-smi">$tasks</span> <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span>filterByProject(<span class="pl-smi">$project_id</span>)<span class="pl-k">-&gt;</span><span class="pl-smi">query</span><span class="pl-k">-&gt;</span>asc(<span class="pl-c1">Task</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.position<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>findAll();</span>
<span class="pl-s1"></span>
<span class="pl-s1">        <span class="pl-k">return</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">board</span><span class="pl-k">-&gt;</span>getBoardByTradeSwimlanes(<span class="pl-smi">$project_id</span>, </span>
<span class="pl-s1">            <span class="pl-k">function</span> (<span class="pl-smi">$project_id</span>, <span class="pl-smi">$column_id</span>, <span class="pl-smi">$swimlane_id</span>) <span class="pl-k">use</span> (<span class="pl-smi">$tasks</span>) {</span>
<span class="pl-s1">                <span class="pl-k">return</span> <span class="pl-c1">array_filter</span>(<span class="pl-smi">$tasks</span>, <span class="pl-k">function</span>(<span class="pl-k">array</span> <span class="pl-smi">$task</span>) <span class="pl-k">use</span> (<span class="pl-smi">$column_id</span>, <span class="pl-smi">$swimlane_id</span>) {</span>
<span class="pl-s1">                    <span class="pl-k">return</span> <span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>column_id<span class="pl-pds">'</span></span>] <span class="pl-k">==</span> <span class="pl-smi">$column_id</span> <span class="pl-k">&amp;&amp;</span> <span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>category_id<span class="pl-pds">'</span></span>] <span class="pl-k">==</span> <span class="pl-smi">$swimlane_id</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">                });</span>
<span class="pl-s1">        });</span>
<span class="pl-s1">    }</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">getBoardByTradeSwimlanes</span>(<span class="pl-smi">$project_id</span>, <span class="pl-smi">$callback</span> <span class="pl-k">=</span> <span class="pl-c1">null</span>)</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-smi">$trades</span> <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">category</span><span class="pl-k">-&gt;</span>getAll(<span class="pl-smi">$project_id</span>);</span>
<span class="pl-s1">        <span class="pl-smi">$columns</span> <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span>getColumns(<span class="pl-smi">$project_id</span>);</span>
<span class="pl-s1">        <span class="pl-smi">$nb_columns</span> <span class="pl-k">=</span> <span class="pl-c1">count</span>(<span class="pl-smi">$columns</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1">        <span class="pl-k">for</span> (<span class="pl-smi">$i</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>, <span class="pl-smi">$ilen</span> <span class="pl-k">=</span> <span class="pl-c1">count</span>(<span class="pl-smi">$trades</span>); <span class="pl-smi">$i</span> <span class="pl-k">&lt;</span> <span class="pl-smi">$ilen</span>; <span class="pl-smi">$i</span><span class="pl-k">++</span>) {</span>
<span class="pl-s1">            <span class="pl-smi">$trades</span>[<span class="pl-smi">$i</span>][<span class="pl-s"><span class="pl-pds">'</span>columns<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-smi">$columns</span>;</span>
<span class="pl-s1">            <span class="pl-smi">$trades</span>[<span class="pl-smi">$i</span>][<span class="pl-s"><span class="pl-pds">'</span>nb_columns<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-smi">$nb_columns</span>;</span>
<span class="pl-s1">            <span class="pl-smi">$trades</span>[<span class="pl-smi">$i</span>][<span class="pl-s"><span class="pl-pds">'</span>nb_tasks<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-c1">0</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">            <span class="pl-k">for</span> (<span class="pl-smi">$j</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>; <span class="pl-smi">$j</span> <span class="pl-k">&lt;</span> <span class="pl-smi">$nb_columns</span>; <span class="pl-smi">$j</span><span class="pl-k">++</span>) {</span>
<span class="pl-s1">                <span class="pl-smi">$column_id</span> <span class="pl-k">=</span> <span class="pl-smi">$columns</span>[<span class="pl-smi">$j</span>][<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>];</span>
<span class="pl-s1">                <span class="pl-smi">$trades_id</span> <span class="pl-k">=</span> <span class="pl-smi">$trades</span>[<span class="pl-smi">$i</span>][<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>];</span>
<span class="pl-s1"></span>
<span class="pl-s1">                <span class="pl-smi">$trades</span>[<span class="pl-smi">$i</span>][<span class="pl-s"><span class="pl-pds">'</span>columns<span class="pl-pds">'</span></span>][<span class="pl-smi">$j</span>][<span class="pl-s"><span class="pl-pds">'</span>tasks<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-smi">$callback</span> <span class="pl-k">===</span> <span class="pl-c1">null</span> ? <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">taskFinder</span></span>
<span class="pl-s1">                    <span class="pl-k">-&gt;</span>getTasksByColumnAndCategory(<span class="pl-smi">$project_id</span>, <span class="pl-smi">$columns</span>[<span class="pl-smi">$j</span>][<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>], <span class="pl-smi">$trades</span>[<span class="pl-smi">$i</span>][<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>])</span>
<span class="pl-s1">                     : $<span class="pl-smi">callback</span>(<span class="pl-smi">$project_id</span>, <span class="pl-smi">$column_id</span>, <span class="pl-smi">$trades_id</span>);</span>
<span class="pl-s1">                <span class="pl-smi">$trades</span>[<span class="pl-smi">$i</span>][<span class="pl-s"><span class="pl-pds">'</span>columns<span class="pl-pds">'</span></span>][<span class="pl-smi">$j</span>][<span class="pl-s"><span class="pl-pds">'</span>nb_tasks<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-c1">count</span>(<span class="pl-smi">$trades</span>[<span class="pl-smi">$i</span>][<span class="pl-s"><span class="pl-pds">'</span>columns<span class="pl-pds">'</span></span>][<span class="pl-smi">$j</span>][<span class="pl-s"><span class="pl-pds">'</span>tasks<span class="pl-pds">'</span></span>]);</span>
<span class="pl-s1">                <span class="pl-smi">$trades</span>[<span class="pl-smi">$i</span>][<span class="pl-s"><span class="pl-pds">'</span>nb_tasks<span class="pl-pds">'</span></span>] <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-smi">$trades</span>[<span class="pl-smi">$i</span>][<span class="pl-s"><span class="pl-pds">'</span>columns<span class="pl-pds">'</span></span>][<span class="pl-smi">$j</span>][<span class="pl-s"><span class="pl-pds">'</span>nb_tasks<span class="pl-pds">'</span></span>];</span>
<span class="pl-s1">            }</span>
<span class="pl-s1">        }</span>
<span class="pl-s1"></span>
<span class="pl-s1">        <span class="pl-k">return</span> <span class="pl-smi">$trades</span>;</span>
<span class="pl-s1">    }</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">getTasksByColumnAndCategory</span>(<span class="pl-smi">$project_id</span>, <span class="pl-smi">$column_id</span>, <span class="pl-smi">$category_id</span>)</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-k">return</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span>getExtendedQuery()</span>
<span class="pl-s1">            <span class="pl-k">-&gt;</span>eq(<span class="pl-c1">Task</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.project_id<span class="pl-pds">'</span></span>, <span class="pl-smi">$project_id</span>)</span>
<span class="pl-s1">            <span class="pl-k">-&gt;</span>eq(<span class="pl-c1">Task</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.column_id<span class="pl-pds">'</span></span>, <span class="pl-smi">$column_id</span>)</span>
<span class="pl-s1">            <span class="pl-k">-&gt;</span>eq(<span class="pl-c1">Task</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.category_id<span class="pl-pds">'</span></span>, <span class="pl-smi">$category_id</span>)</span>
<span class="pl-s1">            <span class="pl-k">-&gt;</span>eq(<span class="pl-c1">Task</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.is_active<span class="pl-pds">'</span></span>, <span class="pl-c1">Task</span><span class="pl-k">::</span><span class="pl-c1">STATUS_OPEN</span>)</span>
<span class="pl-s1">            <span class="pl-k">-&gt;</span>asc(<span class="pl-s"><span class="pl-pds">'</span>tasks.position<span class="pl-pds">'</span></span>)</span>
<span class="pl-s1">            <span class="pl-k">-&gt;</span>findAll();</span>
<span class="pl-s1">    }</span></pre></div>

<h4>
<a id="gantt" class="anchor" href="#gantt" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gantt</h4>

<p><img src="http://i.imgur.com/XrrG6Hv.png" alt="gntt"></p>

<div class="highlight highlight-php"><pre><span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">project</span>()</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-smi">$params</span> <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span>getProjectFilters(<span class="pl-s"><span class="pl-pds">'</span>gantt<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>project<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">        <span class="pl-smi">$filter</span> <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">taskFilter</span><span class="pl-k">-&gt;</span>search(<span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>filters<span class="pl-pds">'</span></span>][<span class="pl-s"><span class="pl-pds">'</span>search<span class="pl-pds">'</span></span>])<span class="pl-k">-&gt;</span>filterByProject(<span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>project<span class="pl-pds">'</span></span>][<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>]);</span>
<span class="pl-s1">        <span class="pl-smi">$sorting</span> <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">request</span><span class="pl-k">-&gt;</span>getStringParam(<span class="pl-s"><span class="pl-pds">'</span>sorting<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>spaces<span class="pl-pds">'</span></span>);        </span>
<span class="pl-s1"></span>
<span class="pl-s1">        <span class="pl-smi">$new_array</span> <span class="pl-k">=</span> <span class="pl-c1">array</span>();</span>
<span class="pl-s1">        <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">taskFinder</span><span class="pl-k">-&gt;</span>recursive(<span class="pl-c1">json_decode</span>(<span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">project</span><span class="pl-k">-&gt;</span>getSpaces(<span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>project<span class="pl-pds">'</span></span>][<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>]), <span class="pl-c1">true</span>),</span>
<span class="pl-s1">         <span class="pl-c1">0</span>, <span class="pl-smi">$new_array</span>, <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>);</span>
<span class="pl-s1">        <span class="pl-c">//$new_array[self::ALL_SPACES] = self::ALL_SPACES;</span></span>
<span class="pl-s1"></span>
<span class="pl-s1">        <span class="pl-k">if</span> (<span class="pl-smi">$sorting</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>date<span class="pl-pds">'</span></span>) {</span>
<span class="pl-s1">            <span class="pl-smi">$filter</span><span class="pl-k">-&gt;</span>getQuery()<span class="pl-k">-&gt;</span>asc(<span class="pl-c1">TaskModel</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.date_started<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>asc(<span class="pl-c1">TaskModel</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.date_creation<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">        } <span class="pl-k">else</span> <span class="pl-k">if</span> (<span class="pl-smi">$sorting</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>board<span class="pl-pds">'</span></span>) {</span>
<span class="pl-s1">            <span class="pl-smi">$filter</span><span class="pl-k">-&gt;</span>getQuery()<span class="pl-k">-&gt;</span>asc(<span class="pl-s"><span class="pl-pds">'</span>column_position<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>asc(<span class="pl-c1">TaskModel</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.position<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">        } <span class="pl-k">else</span> <span class="pl-k">if</span> (<span class="pl-smi">$sorting</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>spaces<span class="pl-pds">'</span></span>) {</span>
<span class="pl-s1">            <span class="pl-c">// filter by spaces</span></span>
<span class="pl-s1">            <span class="pl-smi">$filter</span><span class="pl-k">-&gt;</span>getQuery()<span class="pl-k">-&gt;</span>desc(<span class="pl-c1">TaskModel</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.spaces<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>asc(<span class="pl-c1">TaskModel</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.category_id<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">        } <span class="pl-k">else</span> <span class="pl-k">if</span> (<span class="pl-smi">$sorting</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>category<span class="pl-pds">'</span></span>) {</span>
<span class="pl-s1">            <span class="pl-c">// fileter by construction trade</span></span>
<span class="pl-s1">            <span class="pl-smi">$filter</span><span class="pl-k">-&gt;</span>getQuery()<span class="pl-k">-&gt;</span>asc(<span class="pl-c1">TaskModel</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.category_id<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>desc(<span class="pl-c1">TaskModel</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.spaces<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">        } <span class="pl-k">else</span> <span class="pl-k">if</span> (<span class="pl-smi">$sorting</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>spacesNoMaterials<span class="pl-pds">'</span></span>) {</span>
<span class="pl-s1">            <span class="pl-c">// filter by spaces without Materials</span></span>
<span class="pl-s1">            <span class="pl-smi">$filter</span><span class="pl-k">-&gt;</span>getQuery()<span class="pl-k">-&gt;</span>neq(<span class="pl-c1">TaskModel</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.category_id<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">             <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">category</span><span class="pl-k">-&gt;</span>getIdByName(<span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>project<span class="pl-pds">'</span></span>][<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>], <span class="pl-s"><span class="pl-pds">'</span>Materials<span class="pl-pds">'</span></span>))</span>
<span class="pl-s1">             <span class="pl-k">-&gt;</span>desc(<span class="pl-c1">TaskModel</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.spaces<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>asc(<span class="pl-c1">TaskModel</span><span class="pl-k">::</span><span class="pl-c1">TABLE</span><span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>.category_id<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">        }</span>
<span class="pl-s1"></span>
<span class="pl-s1">        <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">response</span><span class="pl-k">-&gt;</span>html(<span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">template</span><span class="pl-k">-&gt;</span>layout(<span class="pl-s"><span class="pl-pds">'</span>gantt/project<span class="pl-pds">'</span></span>, <span class="pl-smi">$params</span> <span class="pl-k">+</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>users_list<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">projectPermission</span><span class="pl-k">-&gt;</span>getMemberList(<span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>project<span class="pl-pds">'</span></span>][<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>], <span class="pl-c1">false</span>),</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>spaces<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$new_array</span>,</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>sorting<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$sorting</span>,</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>tasks<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$filter</span><span class="pl-k">-&gt;</span>toGanttBars(),</span>
<span class="pl-s1">        )));</span>
<span class="pl-s1">    }</span>
<span class="pl-s1"></span>
<span class="pl-s1">     <span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c">     * Format tasks to be displayed in the Gantt chart</span></span>
<span class="pl-s1"><span class="pl-c">     *</span></span>
<span class="pl-s1"><span class="pl-c">     * <span class="pl-k">@access</span> <span class="pl-k">public</span></span></span>
<span class="pl-s1"><span class="pl-c">     * <span class="pl-k">@return</span> array</span></span>
<span class="pl-s1"><span class="pl-c">     */</span></span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">toGanttBars</span>()</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-smi">$bars</span> <span class="pl-k">=</span> <span class="pl-c1">array</span>();</span>
<span class="pl-s1">        <span class="pl-smi">$columns</span> <span class="pl-k">=</span> <span class="pl-c1">array</span>();</span>
<span class="pl-s1"></span>
<span class="pl-s1">        <span class="pl-k">foreach</span> (<span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">query</span><span class="pl-k">-&gt;</span>findAll() <span class="pl-k">as</span> <span class="pl-smi">$task</span>) {</span>
<span class="pl-s1">            <span class="pl-k">if</span> (<span class="pl-k">!</span> <span class="pl-c1">isset</span>(<span class="pl-smi">$column_count</span>[<span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>project_id<span class="pl-pds">'</span></span>]])) {</span>
<span class="pl-s1">                <span class="pl-smi">$columns</span>[<span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>project_id<span class="pl-pds">'</span></span>]] <span class="pl-k">=</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">board</span><span class="pl-k">-&gt;</span>getColumnsList(<span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>project_id<span class="pl-pds">'</span></span>]);</span>
<span class="pl-s1">            }</span>
<span class="pl-s1"></span>
<span class="pl-s1">            <span class="pl-smi">$start</span> <span class="pl-k">=</span> <span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>date_started<span class="pl-pds">'</span></span>] ?: <span class="pl-c1">time</span>();</span>
<span class="pl-s1">            <span class="pl-smi">$end</span> <span class="pl-k">=</span> <span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>date_due<span class="pl-pds">'</span></span>] ?: <span class="pl-smi">$start</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">            <span class="pl-smi">$bars</span>[] <span class="pl-k">=</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>task<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>start<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">                    (<span class="pl-k">int</span>) <span class="pl-c1">date</span>(<span class="pl-s"><span class="pl-pds">'</span>Y<span class="pl-pds">'</span></span>, <span class="pl-smi">$start</span>),</span>
<span class="pl-s1">                    (<span class="pl-k">int</span>) <span class="pl-c1">date</span>(<span class="pl-s"><span class="pl-pds">'</span>n<span class="pl-pds">'</span></span>, <span class="pl-smi">$start</span>),</span>
<span class="pl-s1">                    (<span class="pl-k">int</span>) <span class="pl-c1">date</span>(<span class="pl-s"><span class="pl-pds">'</span>j<span class="pl-pds">'</span></span>, <span class="pl-smi">$start</span>),</span>
<span class="pl-s1">                ),</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>end<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">                    (<span class="pl-k">int</span>) <span class="pl-c1">date</span>(<span class="pl-s"><span class="pl-pds">'</span>Y<span class="pl-pds">'</span></span>, <span class="pl-smi">$end</span>),</span>
<span class="pl-s1">                    (<span class="pl-k">int</span>) <span class="pl-c1">date</span>(<span class="pl-s"><span class="pl-pds">'</span>n<span class="pl-pds">'</span></span>, <span class="pl-smi">$end</span>),</span>
<span class="pl-s1">                    (<span class="pl-k">int</span>) <span class="pl-c1">date</span>(<span class="pl-s"><span class="pl-pds">'</span>j<span class="pl-pds">'</span></span>, <span class="pl-smi">$end</span>),</span>
<span class="pl-s1">                ),</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>space<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>spaces<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>category<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>category_id<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>column_title<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>column_name<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>assignee<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>assignee_name<span class="pl-pds">'</span></span>] ?: <span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>assignee_username<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>progress<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">task</span><span class="pl-k">-&gt;</span>getProgress(<span class="pl-smi">$task</span>, <span class="pl-smi">$columns</span>[<span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>project_id<span class="pl-pds">'</span></span>]])<span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span>%<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>link<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">helper</span><span class="pl-k">-&gt;</span><span class="pl-smi">url</span><span class="pl-k">-&gt;</span>href(<span class="pl-s"><span class="pl-pds">'</span>task<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>show<span class="pl-pds">'</span></span>, <span class="pl-c1">array</span>(<span class="pl-s"><span class="pl-pds">'</span>project_id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>project_id<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">                     <span class="pl-s"><span class="pl-pds">'</span>task_id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span>])),</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>color<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">color</span><span class="pl-k">-&gt;</span>getColorProperties(<span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>color_id<span class="pl-pds">'</span></span>]),</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>not_defined<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">empty</span>(<span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>date_due<span class="pl-pds">'</span></span>]) <span class="pl-k">||</span> <span class="pl-c1">empty</span>(<span class="pl-smi">$task</span>[<span class="pl-s"><span class="pl-pds">'</span>date_started<span class="pl-pds">'</span></span>]),</span>
<span class="pl-s1">            );</span>
<span class="pl-s1">        }</span>
<span class="pl-s1"></span>
<span class="pl-s1">        <span class="pl-k">return</span> <span class="pl-smi">$bars</span>;</span>
<span class="pl-s1">    }</span></pre></div>

<h3>
<a id="ikan-android-app" class="anchor" href="#ikan-android-app" aria-hidden="true"><span class="octicon octicon-link"></span></a>iKan Android App:</h3>

<p>Android app for Employees on the field (Construction worker, Project )</p>

<table>
<thead>
<tr>
<th align="center">Log in</th>
<th align="center">Projects</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><img src="http://i.imgur.com/G5U0IKa.png" alt=""></td>
<td align="center"><img src="http://i.imgur.com/G9tszYG.png" alt=""></td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
<th align="center">All Trades</th>
<th align="center">Tasks for trade</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><img src="http://i.imgur.com/uftrbWe.png" alt=""></td>
<td align="center"><img src="http://i.imgur.com/Wdsbjbz.png" alt=""></td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
<th align="center">Task</th>
<th align="center">Edit Task</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><img src="http://i.imgur.com/QdswGtP.png" alt=""></td>
<td align="center"><img src="http://i.imgur.com/ruxJFSS.png" alt=""></td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
<th align="center">Sort by Due Date</th>
<th align="center">Search</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><img src="http://i.imgur.com/OCbnJiB.png" alt=""></td>
<td align="center"><img src="http://i.imgur.com/iKW2Lnu.png" alt=""></td>
</tr>
</tbody>
</table>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/hussam789/kanboard">iKan</a> is maintained by <a href="https://github.com/hussam789">hussam789</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
